rm(list=ls())
setwd("C:/Users/polar/Downloads/Sandbox/Teaching/AdvQ/Week 04/02 Exercise/Data")
options(scipen=999) # turn off scientific notations
library(tidyverse)
library(stargazer)
library(lattice)
library(lme4)
library(lmerTest)
#install.packages("lmerTest")
##### Import and merge data #####
dta_country <-  readRDS("Country Covariates.RData")
dta_country$country <- rownames(dta_country)
dta_country <- dta_country %>%
dplyr::select(struggle, # percent seeing a reformer-Islamist struggle
pctmus, # percent Muslim in country
log.gdppc, # (natural) log of per capita GDP
country)
ls(dta_country)
dta <- readRDS("Pew GAP 2007.RData")
dta_gap <- dta %>%
dplyr::select(country,
us.scale, # Anti-Americanism scale: 1=most AA, 0=least AA
pious, # Individual: 1=highly religious, 0=less religious
news, # Follow intl news: 1=frequently, 0=only when important
satisfied, # satisfied with how things going in country
age,
male,
ses,
ed2,
ed3) %>%
mutate(age = age/100,
serial = 1:nrow(dta)) #%>%
#filter(male == 1,
#       age >= 0.5)
ls(dta_gap)
summary(dta_gap)
head(dta_gap)
### Merge data
dta_all <- merge(dta_gap, dta_country, by="country") %>%
unique() %>%
drop_na()
summary(dta_all)
head(dta_all)
##### Task 1: LMM with random intercept #####
mod_lmm_1 <- lmer(us.scale ~ 1 + (1|country), data=dta_all)
summary(mod_lmm_1)
coef(mod_lmm_1)
fixef(mod_lmm_1) # fixed part of each intercept
ranef(mod_lmm_1) # random part of each intercept
dotplot(ranef(mod_lmm_1, condVar = TRUE)) # show the random part of each intercept with CIs
mod_lmm_4 <- lmer(us.scale ~ ed3 + (ed3|country), data=dta_all)
summary(mod_lmm_4)
